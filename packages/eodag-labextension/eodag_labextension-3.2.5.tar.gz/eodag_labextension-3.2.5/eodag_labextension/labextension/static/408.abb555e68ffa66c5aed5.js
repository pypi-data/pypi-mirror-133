"use strict";(self.webpackChunkeodag_labextension=self.webpackChunkeodag_labextension||[]).push([[408],{2408:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ie});var r=n(1539),o=n(4582),a=n(3379),i=n.n(a),l=n(2760);i()(l.Z,{insert:"head",singleton:!1}),l.Z.locals,n(623),n(4438);var d=n(6271),s=n.n(d),p=n(4456),c=n(3706),g=n(2835),u=n(5215),h=n(8174),m=n.n(h),E=n(2135),f=n(2451),b=n(2978),j=n(8899),v=n.n(j),y=(n(9339),n(8261),n(7506)),w=n.n(y),x=n(8125),W=n.n(x);const k={NoOptionsMessage:function(e){return d.createElement("div",Object.assign({color:"textSecondary",style:{padding:"8px 16px"}},e.innerProps),e.children)},Option:function(e){return d.createElement("div",{"data-for":e.label,"data-tip":e.data.description},d.createElement(y.components.Option,Object.assign({},e),e.children),d.createElement(W(),{id:e.label,className:"jp-Eodag-tooltip",place:"right",type:"dark",effect:"solid"}))},SingleValue:function(e){return d.createElement("div",Object.assign({style:{fontSize:14}},e.innerProps),e.children)},ValueContainer:function(e){return d.createElement("div",{style:{display:"flex",flexWrap:"wrap",flex:1,paddingLeft:5,alignItems:"center",overflow:"hidden"}},e.children)}};class C extends d.Component{render(){const{suggestions:e,value:t,handleChange:n}=this.props,r=t?e.find((e=>e.value===t)):void 0;return d.createElement("div",{className:"jp-EodagWidget-field"},d.createElement("label",{className:"jp-EodagWidget-input-name"},"Product type (*)",d.createElement("div",{style:{marginTop:10}},d.createElement(w(),{className:"jp-EodagWidget-select",classNamePrefix:"jp-EodagWidget-select",options:e,components:k,value:r,onChange:n,placeholder:"S3_...",isClearable:!0}))))}}const S=C,F="https://a.tile.openstreetmap.org/{z}/{x}/{y}.png",M="&copy; <a href=&quot;http://osm.org/copyright&quot;>OpenStreetMap</a> contributors";function N(e){const t=new Date(e);return t.setMinutes(e.getMinutes()-e.getTimezoneOffset()),function(e){return e.slice(0,10)}(t.toJSON())}const T=new class{getSearchURL(e){const t=b.ServerConnection.makeSettings(),n=f.URLExt.join(t.baseUrl,"eodag");return f.URLExt.join(n,`${e}`)}search(e=1,t){const n=this.getSearchURL(t.productType);let r={dtstart:t.startDate?N(t.startDate):void 0,dtend:t.endDate?N(t.endDate):void 0,cloudCover:t.cloud,page:e,geom:t.geometry};t.additionnalParameters&&(r=m().extend(r,m().fromPairs(t.additionnalParameters.filter((({name:e,value:t})=>""!==e&&""!==t)).map((({name:e,value:t})=>[e,t])))));const o=new Headers({"Content-Type":"application/json"});if("undefined"!=typeof document&&(null===document||void 0===document?void 0:document.cookie)){const e=this.getCookie("_xsrf");void 0!==e&&o.append("X-XSRFToken",e)}const a=new Request(n,{credentials:"same-origin",method:"POST",body:JSON.stringify(r),headers:o});return fetch(a).then((async e=>{if(!e.ok){const t=await e.json();throw new Error(`${t.error}`)}return e.json()}))}getCookie(e){const t=document.cookie.match("\\b"+e+"=([^;]*)\\b");return null==t?void 0:t[1]}};var D=n(7700),R=n(5378);class z extends d.Component{constructor(e){super(e),this.EditOptions={polyline:!1,polygon:!0,circle:!1,marker:!1,circlemarker:!1},this.invalidateMapSize=(0,h.throttle)((()=>{this.map.leafletElement.invalidateSize()}),500),this.onDrawStop=e=>{this.saveGeometry(e.target)},this.onEditStop=e=>{this.saveGeometry(e.target)},this.onDeleted=e=>{try{this.saveGeometry(e.target)}catch(e){const t=void 0;this.setState({geometry:t},(()=>{this.props.onChange(t)}))}},this.saveGeometry=e=>{const t=this.getGeometry(e);this.setState({geometry:t},(()=>{this.props.onChange(t)}))},this.getGeometry=e=>{const t=[];let n;e.eachLayer((e=>{var n;return t.push(null===(n=e.toGeoJSON)||void 0===n?void 0:n.call(e))}));const r=t.filter((e=>"Feature"===(null==e?void 0:e.type))).map((e=>e.geometry)).filter((e=>"Polygon"===e.type));return n=r.length>1?{type:"MultiPolygon",coordinates:r.map((e=>e.coordinates))}:null==r?void 0:r[0],n},this.state={lat:46.8,lon:1.8,zoom:4,geometry:e.geometry}}componentDidMount(){const e=setInterval((()=>{const t=new MutationObserver((e=>{this.invalidateMapSize()})),n=document.querySelector(".jp-EodagWidget");n&&(t.observe(n,{attributes:!0}),clearInterval(e)),this.invalidateMapSize()}),100)}render(){const{zoom:e,lat:t,lon:n}=this.state,r=[t,n];return d.createElement(D.Map,{center:r,zoom:e,ref:e=>{this.map=e}},d.createElement(D.TileLayer,{url:F,attribution:M}),d.createElement(D.FeatureGroup,null,d.createElement(R.EditControl,{position:"topright",draw:this.EditOptions,onDrawStop:this.onDrawStop,onEdited:this.onEditStop,onDeleted:this.onDeleted})))}}const O=({handleShowFeature:e,saveFormValues:t})=>{const[n,r]=(0,d.useState)(),[o,a]=(0,d.useState)(void 0),[i,l]=(0,d.useState)(void 0),[p,c]=(0,d.useState)(100),[g,j]=(0,d.useState)(!1),{control:y,handleSubmit:w,clearErrors:x,register:W,formState:{errors:k}}=(0,E.useForm)({defaultValues:{startDate:void 0,endDate:void 0,cloud:100}});return(0,d.useEffect)((()=>{const e=b.ServerConnection.makeSettings(),t=f.URLExt.join(e.baseUrl,"eodag");fetch(f.URLExt.join(t,"product-types/"),{credentials:"same-origin"}).then((e=>{if(e.status>=400)throw(0,u.showErrorMessage)(`Unable to contact the EODAG server. Are you sure the adress is ${t}/ ?`,{}),new Error("Bad response from server");return e.json()})).then((e=>{const t=(0,h.map)(e,(e=>({value:e.ID,label:e.ID,description:e.abstract})));r(t)})).catch((()=>{(0,u.showErrorMessage)(`Unable to contact the EODAG server. Are you sure the adress is ${t}/ ?`,{})}))}),[]),(0,d.useEffect)((()=>{m().isEmpty(k)||(0,u.showErrorMessage)("The following fields are required",m().keys(k).join(", ")).then((()=>x()))}),[k.productType]),s().createElement("form",{onSubmit:w((n=>{t(n),j(!0),T.search(1,n).then((e=>{var t;if(0===(null===(t=null==e?void 0:e.features)||void 0===t?void 0:t.length))throw new Error("No result found");return e})).then((t=>{j(!1),e(t)})).catch((e=>{(0,u.showErrorMessage)("Bad response from server:",e),j(!1)}))})),className:"jp-EodagWidget-form"},s().createElement("div",{className:"jp-EodagWidget-map"},s().createElement(E.Controller,{name:"geometry",control:y,rules:{required:!1},render:({field:{onChange:e,value:t}})=>s().createElement(z,{geometry:t,onChange:e})})),s().createElement("div",{className:"jp-EodagWidget-field"},s().createElement(E.Controller,{name:"productType",control:y,rules:{required:!0},render:({field:{onChange:e,value:t}})=>s().createElement(S,{suggestions:n,value:t,handleChange:t=>e(null==t?void 0:t.value)})}),s().createElement("fieldset",null,s().createElement("legend",null,"Date range"),s().createElement("label",{htmlFor:"startDate",className:"jp-EodagWidget-input-name"},"Start"),s().createElement("div",{className:"jp-EodagWidget-input-wrapper"},s().createElement(E.Controller,{name:"startDate",control:y,rules:{required:!1},render:({field:{onChange:e,onBlur:t,value:n}})=>s().createElement(v(),{className:"jp-EodagWidget-input",selectsStart:!0,startDate:o,endDate:i,maxDate:i,onChange:t=>{a(t),e(t)},onBlur:t,selected:n,dateFormat:"dd/MM/yyyy",showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",isClearable:!0})})),s().createElement("label",{htmlFor:"endDate",className:"jp-EodagWidget-input-name"},"End"),s().createElement("div",{className:"jp-EodagWidget-input-wrapper"},s().createElement(E.Controller,{name:"endDate",control:y,rules:{required:!1},render:({field:{onChange:e,onBlur:t,value:n}})=>s().createElement(v(),{className:"jp-EodagWidget-input",selectsEnd:!0,startDate:o,endDate:i,minDate:o,onChange:t=>{l(t),e(t)},onBlur:t,selected:n,dateFormat:"dd/MM/yyyy",showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",isClearable:!0})}))),s().createElement("label",{className:"jp-EodagWidget-input-name"},"Max cloud cover ",p,"%",s().createElement("div",{className:"jp-EodagWidget-slider"},s().createElement(E.Controller,{name:"cloud",control:y,rules:{required:!1},render:({field:{onChange:e,value:t}})=>s().createElement("input",{type:"range",min:"0",max:"100",value:t,"aria-labelledby":"cloud",onChange:t=>{const n=parseInt(t.target.value,10);e(n),c(n)}})})))),s().createElement(_,Object.assign({},{control:y,register:W})),s().createElement("div",{className:"jp-EodagWidget-buttons"},s().createElement("button",{type:"submit",color:"primary",disabled:g},g?"Searching...":"Search")))},_=({control:e,register:t})=>{const{fields:n,append:r,remove:o}=(0,E.useFieldArray)({control:e,name:"additionnalParameters"});return s().createElement("fieldset",{className:"jp-EodagWidget-additionnalParameters-fieldset"},s().createElement("legend",null,"Additionnal Parameters"),n.map(((e,n)=>s().createElement("div",{key:e.id},s().createElement("section",{className:"section",key:e.id},s().createElement("input",Object.assign({placeholder:"Name"},t(`additionnalParameters.${n}.name`))),s().createElement("input",Object.assign({placeholder:"Value"},t(`additionnalParameters.${n}.value`))),s().createElement("button",{type:"button",className:"jp-EodagWidget-additionnalParameters-deletebutton",onClick:()=>o(n)},"x"))))),s().createElement("button",{type:"button",className:"jp-EodagWidget-additionnalParameters-addbutton",onClick:()=>r({})},"Add search parameter"))};var G=n(6915),L=n.n(G),P=n(1795),H=n.n(P);class I extends d.Component{constructor(e){super(e),this.EditOptions={polyline:!1,polygon:!1,circle:!1,marker:!1,circlemarker:!1},this.onMouseOver=e=>{const t=e.layer.feature.id;this.props.handleHoverFeature(t),e.layer.setStyle(I.HIGHLIGHT_EXTENT_STYLE),e.layer.bringToFront(),this.setState({featureHover:t})},this.onMouseOut=e=>{this.props.handleHoverFeature(null),e.layer.setStyle(I.DEFAULT_EXTENT_STYLE),this.setState({featureHover:null})},this.onClick=e=>{const t=e.propagatedFrom.feature.id;this.props.handleClickFeature(t)},this.getStyle=e=>{const{highlightFeature:t}=this.props,{featureHover:n}=this.state;return(0,h.get)(t,"id")===e.id||n===e.id?I.HIGHLIGHT_EXTENT_STYLE:I.DEFAULT_EXTENT_STYLE};const t=new(H().GeoJSON)(e.features.features).getBounds();this.state={bounds:t,featureHover:null}}componentDidUpdate(e){if(this.map){if(e.zoomFeature!==this.props.zoomFeature&&this.props.zoomFeature){let t;this.map.leafletElement.eachLayer((n=>{(0,h.get)(n,"feature.id",null)===e.highlightFeature.id&&(t=n.getBounds())})),t&&this.map.leafletElement.flyToBounds(t,{})}e.highlightFeature!==this.props.highlightFeature&&(this.props.highlightFeature?this.map.leafletElement.eachLayer((e=>{(0,h.get)(e,"feature.id",null)===this.props.highlightFeature.id&&(e.bringToFront(),e.setStyle(I.HIGHLIGHT_EXTENT_STYLE))})):this.map.leafletElement.eachLayer((t=>{(0,h.get)(t,"feature.id",null)===e.highlightFeature.id&&t.setStyle(I.DEFAULT_EXTENT_STYLE)})))}}render(){const{bounds:e}=this.state;return d.createElement(D.Map,{bounds:e,ref:e=>{this.map=e}},d.createElement(D.TileLayer,{url:F,attribution:M}),(0,h.isEmpty)(this.props.features)?null:d.createElement(D.GeoJSON,{key:`features-gson-${(0,h.get)(this.props.features,"features",[]).length}`,data:this.props.features,style:this.getStyle,onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver,onclick:this.onClick}))}}I.DEFAULT_EXTENT_STYLE={color:"#3f51b5",fillOpacity:.01},I.HIGHLIGHT_EXTENT_STYLE={color:"#76ff03",fillOpacity:.01};var A=n(4184),U=n.n(A),q=n(2510),B=n(7522),$=n(4222),V=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const Z=({active:e,direction:t,children:n})=>d.createElement("div",null,"TableSortLabel");class Q extends d.PureComponent{constructor(){super(...arguments),this.getRowClassName=({index:e})=>e<0?" headerRow flexContainer":"tableRow flexContainer",this.getRowStyle=({index:e})=>{if(e>=0){const{rowGetter:t,highlightFeature:n}=this.props,r=t({index:e});if((0,h.get)(n,"id")===(0,h.get)(r,"id"))return{backgroundColor:"#eeeeee"}}return{}},this.cellRenderer=({cellData:e,columnIndex:t=null})=>{const{columns:n}=this.props;let r=!1;return null!=t&&n[t].percent&&(r=!0===n[t].percent),null!=e?d.createElement("div",null,r?`${parseInt(e,10)} %`:e):d.createElement("div",null)},this.buttonRenderer=({columnIndex:e=null,rowData:t})=>{const{columns:n}=this.props;let r=e=>{};return null!=e&&n[e].handleClick&&(r=n[e].handleClick),d.createElement("button",{onClick:()=>{r(t.id)}},d.createElement(B.FontAwesomeIcon,{icon:$.faSearchPlus}))},this.selectorRenderer=({columnIndex:e=null})=>d.createElement("div",null,"Cellule selector"),this.headerRenderer=({label:e,disableSort:t,dataKey:n,sortBy:r,sortDirection:o})=>{const{sort:a}=this.props,i={[q.SortDirection.ASC]:"asc",[q.SortDirection.DESC]:"desc"},l=t||null==a?e:d.createElement(Z,{active:n===r,direction:i[o]},e);return d.createElement("div",null," ",l," ")}}render(){const e=this.props,{classes:t,columns:n,rowCount:r,displayedRowCount:o,isRowLoaded:a,isRetrievingMoreFeature:i,handleRetrieveMoreFeature:l}=e,s=V(e,["classes","columns","rowCount","displayedRowCount","isRowLoaded","isRetrievingMoreFeature","handleRetrieveMoreFeature"]),p=()=>!i()&&l();return d.createElement(q.AutoSizer,null,(({height:e,width:t})=>d.createElement(q.InfiniteLoader,{isRowLoaded:a,loadMoreRows:p,rowCount:r},(({onRowsRendered:r,registerChild:a})=>d.createElement(q.Table,Object.assign({ref:a,onRowsRendered:r,key:"table",className:"table",height:e,width:t},s,{rowClassName:this.getRowClassName,rowStyle:this.getRowStyle,rowCount:o}),n.map(((e,t)=>{var{cellContentRenderer:r=null,className:o,dataKey:a,buttons:i,selector:l}=e,s=V(e,["cellContentRenderer","className","dataKey","buttons","selector"]);let p;return p=null!=r?e=>this.cellRenderer({cellData:r(e),columnIndex:t}):i?this.buttonRenderer:l?this.selectorRenderer:this.cellRenderer,d.createElement(q.Column,Object.assign({key:a,headerRenderer:e=>this.headerRenderer(Object.assign(Object.assign({},e),{disableSort:n[t].disableSort})),className:U()(o),cellRenderer:p,dataKey:a},s))})))))))}}Q.defaultProps={headerHeight:56,rowHeight:56};const Y=function({features:e,handleClickFeature:t,handleZoomFeature:n,handleHoverFeature:r,highlightFeature:o,isRetrievingMoreFeature:a,handleRetrieveMoreFeature:i}){return d.createElement(Q,{rowCount:e.properties.totalResults,displayedRowCount:e.features.length,rowGetter:(e=>({index:t})=>t>=e.features.length?{}:Object.assign(Object.assign({},e.features[t].properties),{id:e.features[t].id}))(e),onRowClick:({rowData:e})=>{t(e.id)},onRowMouseOver:({rowData:e})=>{r(e.id)},onRowMouseOut:()=>{r(null)},isRowLoaded:({index:t})=>t<e.features.length,highlightFeature:o,isRetrievingMoreFeature:a,handleRetrieveMoreFeature:i,columns:[{width:100,flexGrow:3,label:"Start time",dataKey:"startTimeFromAscendingNode"},{width:100,flexGrow:3,label:"End time",dataKey:"startTimeFromAscendingNode"},{width:100,flexGrow:1,label:"Cloud cover",dataKey:"cloudCover",percent:!0},{width:100,flexGrow:1,label:"Actions",dataKey:"",buttons:!0,handleClick:n}]})},K=["platformSerialIdentifier","instrument","productType","processingLevel","sensorMode","startTimeFromAscendingNode","completionTimeFromAscendingNode","orbitDirection","orbitNumber","cloudCover"];class X extends d.Component{constructor(e){super(e),this.toggleQuicklookSize=()=>{const{smallQuicklook:e}=this.state;this.setState({smallQuicklook:!e})},this.state={smallQuicklook:!0,featureProperties:void 0}}componentDidUpdate(e){if(e.feature!==this.props.feature&&Boolean(this.props.feature)){const e=this.organizeProperties();this.setState({featureProperties:e})}}organizeProperties(){const{properties:e}=this.props.feature,t=[];K.forEach((n=>{const r=e[n];var o,a;null!=r&&""!==r&&0!==r.length&&t.push([n,(o=n,a=r,"cloudCover"===o?`${Math.round(a)} %`:a)])}));const n=m().toPairs(m().pickBy(e,((e,t)=>(m().isNumber(e)||m().isString(e)||m().isArray(e)&&0!==e.length&&e.every(m().isString))&&!K.includes(t)&&!t.startsWith("eodag")&&null!=e&&""!==e))).sort();return t.concat(n).map((([e,t])=>({key:m().capitalize(e.split(/(?=[A-Z])/).join(" ")),value:t})))}render(){const{feature:e}=this.props,{featureProperties:t,smallQuicklook:n}=this.state;return e&&t?d.createElement("div",{className:"jp-EodagWidget-product"},d.createElement("h4",null,"Quicklook"),d.createElement("div",{className:"jp-EodagWidget-quicklook-wrapper"},d.createElement("img",{src:e.properties.quicklook,alt:"Quicklook not available",className:n?"jp-EodagWidget-small-quicklook":"",onClick:this.toggleQuicklookSize})),d.createElement("h4",null,"Metadata"),d.createElement("table",{className:"result-table"},t.map((({key:e,value:t})=>d.createElement("tr",null,d.createElement("td",null,e),d.createElement("td",null,"string"==typeof t&&t.startsWith("http")?d.createElement("a",{href:t,target:"_blank"},t):t)))))):null}}const J={content:{top:"0px",left:"0px",right:"auto",bottom:"auto",height:"auto",width:"100%",zIndex:4,marginRight:"0",padding:"0",borderRadius:"none",border:"none"}};function ee(e){return d.createElement("div",Object.assign({direction:"up"},e))}L().defaultStyles.overlay.zIndex=4,L().setAppElement("body");class te extends d.Component{constructor(e){super(e),this.getFeature=e=>{const{features:t}=this.props;return(0,h.find)(t.features,(t=>t.id===e))},this.handleClickFeature=e=>{const t=this.getFeature(e);t&&this.setState({displayFeature:t})},this.handleHoverMapFeature=e=>{if(e){const t=this.getFeature(e);t&&this.setState({highlightOnTableFeature:t})}else this.setState({highlightOnTableFeature:null})},this.handleHoverTableFeature=e=>{if(e){const t=this.getFeature(e);t&&this.setState({highlightOnMapFeature:t})}else this.setState({highlightOnMapFeature:null})},this.handleZoomFeature=e=>{const t=this.getFeature(e);t&&this.setState({zoomFeature:t})},this.state={features:[],displayFeature:null,highlightOnMapFeature:null,highlightOnTableFeature:null,zoomFeature:null}}componentDidUpdate(e){(0,h.isEqual)(e.features,this.props.features)||this.setState({displayFeature:null})}render(){const{features:e,open:t,handleClose:n,isRetrievingMoreFeature:r,handleRetrieveMoreFeature:o,handleGenerateQuery:a}=this.props,{zoomFeature:i,highlightOnMapFeature:l,highlightOnTableFeature:s,displayFeature:p}=this.state;return d.createElement(L(),{isOpen:t,contentLabel:"Modal",style:J,"data-TransitionComponent":ee},d.createElement("div",{className:"jp-EodagWidget-modal"},d.createElement("div",{className:"jp-EodagWidget-appbar"},d.createElement("button",{onClick:n},d.createElement(B.FontAwesomeIcon,{icon:$.faTimes})),"Search results",d.createElement("button",{"data-for":"apply-tooltip","data-tip":"Generate the python code",className:"jp-EodagWidget-apply",onClick:a},"Apply"),d.createElement(W(),{id:"apply-tooltip",className:"jp-Eodag-tooltip",place:"bottom",type:"dark",effect:"solid"})),d.createElement("div",{className:"jp-EodagWidget-modal-container"},d.createElement("div",{className:"jp-EodagWidget-product-wrapper"},d.createElement(I,{features:e,zoomFeature:i,highlightFeature:l,handleHoverFeature:this.handleHoverMapFeature,handleClickFeature:this.handleClickFeature}),d.createElement("div",{className:"jp-EodagWidget-browse-title"},r()?d.createElement("div",{"data-for":"load-tooltip","data-tip":"Loading more products",className:"jp-EodagWidget-loading-wrapper"},d.createElement(B.FontAwesomeIcon,{icon:$.faSpinner,spin:!0}),d.createElement(W(),{id:"load-tooltip",className:"jp-Eodag-tooltip",place:"bottom",type:"dark",effect:"solid"})):null,(0,h.get)(e,"features",[]).length," results (total:"," ",(0,h.get)(e,"properties.totalResults",0),")"),d.createElement("div",{className:"jp-EodagWidget-browse-wrapper"},d.createElement(Y,{features:e,highlightFeature:s,handleClickFeature:this.handleClickFeature,handleZoomFeature:this.handleZoomFeature,handleHoverFeature:this.handleHoverTableFeature,isRetrievingMoreFeature:r,handleRetrieveMoreFeature:o}))),d.createElement("div",{className:"jp-EodagWidget-desc-wrapper"},d.createElement(X,{feature:p})))))}}var ne=n(8716);class re extends d.Component{constructor(e){super(e),this.handleShowFeature=e=>{this.setState({features:e,openDialog:!0})},this.handleRetrieveMoreFeature=()=>{const{features:e}=this.state;return this.setState({searching:!0}),T.search((0,h.get)(e,"properties.page",1)+1,this.state.formValues).then((t=>{const n=(0,h.concat)((0,h.get)(e,"features",[]),t.features);this.setState({searching:!1,features:Object.assign(Object.assign({},t),{features:n})})})).catch((()=>{this.setState({searching:!1})}))},this.isRetrievingMoreFeature=()=>this.state.searching,this.getCodeCell=e=>new g.CodeCellModel({cell:{cell_type:"code",metadata:{trusted:!1,collapsed:!1,tags:["Injected by EODAG plugin"]},source:[e]}}),this.handleGenerateQuery=()=>{if(this.setState({openDialog:!1}),!this.props.tracker.currentWidget)return;const e=this.props.tracker.currentWidget.content,t=e.model;if("python"!==t.defaultKernelLanguage)return void(0,u.showErrorMessage)("Active notebook uses wrong kernel language. Only python is supported",{});if(t.readOnly)return void(0,u.showErrorMessage)("Unable to inject cell into read-only notebook",{});const n=(({startDate:e,endDate:t,productType:n,geometry:r,cloud:o,additionnalParameters:a})=>{const i=e?N(e):void 0,l=t?N(t):void 0,d=(null==r?void 0:r.type)&&(null==r?void 0:r.coordinates);let s="from eodag import EODataAccessGateway, setup_logging\n\nsetup_logging(1) # 0: nothing, 1: only progress bars, 2: INFO, 3: DEBUG\n\ndag = EODataAccessGateway()\n";return d&&(s+=`geometry = "${(0,ne.geojsonToWKT)(r)}"\n`),s+=`search_results, total_count = dag.search(\n  productType="${n}",\n`,d&&(s+="  geom=geometry,\n"),i&&(s+=`  start="${i}",\n`),l&&(s+=`  end="${l}",\n`),void 0!==o&&(s+=`  cloudCover=${o},\n`),(null==a?void 0:a.length)>0&&(s+=a.filter((({name:e,value:t})=>""!==e&&""!==t)).map((({name:e,value:t})=>`  ${e}="${t}",`)).join("\n")+"\n"),s+=")",s})(this.state.formValues),r=this.getCodeCell(n),a=e.activeCellIndex;t.cells.insert(a+1,r),o.NotebookActions.selectBelow(e)},this.handleCloseModal=()=>{this.setState({openDialog:!1})},this.state={features:{},openDialog:!1,searching:!1,formValues:void 0}}render(){const{openDialog:e,features:t}=this.state;return d.createElement("div",null,d.createElement("header",{className:"jp-EodagWidget-header"},"Products search"),d.createElement(O,{handleShowFeature:this.handleShowFeature,saveFormValues:e=>this.setState({formValues:e})}),d.createElement(te,{open:e,features:t,handleClose:this.handleCloseModal,handleGenerateQuery:this.handleGenerateQuery,isRetrievingMoreFeature:this.isRetrievingMoreFeature,handleRetrieveMoreFeature:this.handleRetrieveMoreFeature}))}}const oe=new(n(7563).LabIcon)({name:"eodag-labextension:logo",svgstr:'<?xml version="1.0" encoding="iso-8859-1"?>\r\n\x3c!-- Generator: Adobe Illustrator 17.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\r\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\r\n<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\r\n\t viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\r\n<g class="jp-icon3">\r\n\t<path class="jp-icon3" fill="#616161" d="M448.735,63.265C407.938,22.468,353.696,0,296,0S184.062,22.468,143.265,63.265C102.468,104.063,80,158.305,80,216\r\n\t\tc0,11.12,0.853,22.287,2.536,33.191c0.673,4.367,4.756,7.36,9.126,6.687c4.367-0.674,7.36-4.76,6.687-9.126\r\n\t\tc-1.155-7.487-1.886-15.111-2.188-22.752H104c4.418,0,8-3.582,8-8s-3.582-8-8-8h-7.826c1.386-35.051,11.824-67.813,29.054-96\r\n\t\th30.471c-8.933,21.976-15.031,46.03-17.86,71.1c-0.495,4.391,2.662,8.352,7.053,8.847c4.385,0.506,8.351-2.661,8.847-7.052\r\n\t\tc2.929-25.959,9.557-50.699,19.329-72.895h59.449c-2.77,15.705-4.807,31.784-6.14,47.314c-0.378,4.401,2.885,8.276,7.287,8.654\r\n\t\tc4.409,0.363,8.277-2.885,8.655-7.287c1.466-17.084,3.628-33.467,6.39-48.682h94.622c5.246,28.888,8.219,61.678,8.62,96H328\r\n\t\tc-4.418,0-8,3.582-8,8s3.582,8,8,8h23.949c-0.604,51.771-7.06,100.063-18.34,136.726C322.959,395.337,308.9,416,296,416\r\n\t\tc-12.94,0-25.885-1.243-38.474-3.695c-4.337-0.847-8.537,1.986-9.382,6.323s1.986,8.537,6.323,9.382\r\n\t\tC268.062,430.657,282.035,432,296,432c57.696,0,111.938-22.468,152.735-63.265C489.532,327.938,512,273.695,512,216\r\n\t\tS489.532,104.063,448.735,63.265z M466.772,320h-30.416c11.891-29.219,18.614-61.927,19.525-96h39.945\r\n\t\tC494.44,259.051,484.002,291.813,466.772,320z M455.881,208c-0.911-34.073-7.634-66.781-19.525-96h30.416\r\n\t\tc17.229,28.187,27.667,60.949,29.054,96H455.881z M455.899,96h-26.743c-5.593-11.284-12.008-21.934-19.216-31.798\r\n\t\tc-7.265-9.941-15.124-18.798-23.463-26.536C413.835,51.602,437.578,71.65,455.899,96z M411.127,96H356.39\r\n\t\tc-6.596-31.145-15.945-57.651-27.905-74.868C362.004,31.907,391.076,58.986,411.127,96z M136.101,96\r\n\t\tc18.354-24.396,42.152-44.47,69.574-58.41c-5.265,4.854-10.336,10.141-15.172,15.865C179.886,66.022,170.619,80.353,162.886,96\r\n\t\tH136.101z M180.891,96c6.356-11.73,13.666-22.55,21.835-32.219c17.627-20.863,38.507-35.369,60.743-42.568\r\n\t\tC251.2,38.984,242.001,66.177,235.627,96H180.891z M251.93,96c3.514-15.807,7.715-29.99,12.477-41.911\r\n\t\tC274.077,29.883,285.591,16,296,16c12.9,0,26.959,20.663,37.608,55.274c2.383,7.746,4.547,16.019,6.491,24.726H251.93z\r\n\t\t M359.469,112h59.487c12.405,28.187,19.921,60.949,20.919,96h-71.928C367.546,175.144,364.682,141.943,359.469,112z M439.875,224\r\n\t\tc-0.998,35.051-8.514,67.813-20.919,96h-59.487c5.214-29.943,8.077-63.144,8.478-96H439.875z M356.39,336h54.737\r\n\t\tc-20.051,37.014-49.123,64.093-82.641,74.868C340.445,393.651,349.794,367.145,356.39,336z M386.477,394.334\r\n\t\tc8.339-7.738,16.198-16.595,23.463-26.536c7.208-9.864,13.623-20.514,19.216-31.798h26.743\r\n\t\tC437.578,360.35,413.835,380.398,386.477,394.334z"/>\r\n\t<path class="jp-icon3" fill="#616161" d="M216,408c61.757,0,112-50.243,112-112s-50.243-112-112-112s-112,50.243-112,112c0,28.005,10.333,53.643,27.385,73.301\r\n\t\tl-17.034,17.034C111.161,384.808,107.643,384,104,384c-6.415,0-12.442,2.498-16.969,7.03l-80,80C2.497,475.564,0,481.591,0,488\r\n\t\ts2.497,12.436,7.027,16.966C11.558,509.502,17.585,512,24,512s12.442-2.498,16.969-7.03l80-80\r\n\t\tc7.372-7.372,8.91-18.377,4.667-27.292l17.063-17.063C162.357,397.667,187.995,408,216,408z M216,200c52.935,0,96,43.065,96,96\r\n\t\ts-43.065,96-96,96s-96-43.065-96-96S163.065,200,216,200z M109.656,413.655l-80.003,80.004C28.145,495.169,26.137,496,24,496\r\n\t\ts-4.145-0.831-5.656-2.345c-3.118-3.118-3.118-8.192,0-11.311l80.003-80.004c1.508-1.51,3.515-2.341,5.652-2.341\r\n\t\ts4.145,0.831,5.656,2.345C112.774,405.463,112.774,410.537,109.656,413.655z"/>\r\n\t<path class="jp-icon3" fill="#616161" d="M216,232c35.29,0,64,28.71,64,64c0,4.418,3.582,8,8,8s8-3.582,8-8c0-44.112-35.888-80-80-80c-4.418,0-8,3.582-8,8\r\n\t\tS211.582,232,216,232z"/>\r\n</g>\r\n</svg>\r\n'});class ae extends c.Widget{constructor(e){super(),this.title.caption="EODAG",this.title.icon=oe,this.id="eodag-widget",this.tracker=e,this.addClass("jp-EodagWidget"),this.update()}onUpdateRequest(){p.unmountComponentAtNode(this.node),p.render(d.createElement(re,{tracker:this.tracker}),this.node)}}const ie={id:"eodag-labextension:plugin",autoStart:!0,requires:[o.INotebookTracker,r.ILayoutRestorer],activate:function(e,t,n){const r=new ae(t);n.add(r,"eodag-widget"),e.shell.add(r,"left",{rank:700})}}},1150:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3645),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".jp-EodagWidget {\n  display: flex;\n  flex-direction: column;\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n  font-size: var(--jp-ui-font-size1);\n  overflow: auto;\n  padding: 5px;\n}\n\n.jp-EodagWidget-header {\n  border-bottom: var(--jp-border-width) solid var(--jp-border-color2);\n  flex: 0 0 auto;\n  font-size: var(--jp-ui-font-size0);\n  font-weight: 600;\n  letter-spacing: 1px;\n  margin: 0px;\n  padding: 8px 12px;\n  text-transform: uppercase;\n}\n\n.jp-EodagWidget .jp-EodagWidget-form {\n  display: flex;\n  flex-direction: column;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-buttons {\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-buttons button {\n  cursor: pointer;\n  margin: 0 15px;\n  font-size: 16px;\n  padding: 5px;\n  color: var(--jp-ui-font-color1);\n  background: var(--jp-layout-color1);\n  border: none;\n  box-sizing: border-box;\n  outline: none;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  padding: 7px;\n  margin: 0px;\n  border-radius: var(--jp-border-radius);\n  display: flex;\n  align-items: center;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-buttons button:hover {\n  background: var(--jp-layout-color2);\n}\n.jp-EodagWidget .jp-EodagWidget-form .react-datepicker-popper {\n  position: relative;\n  z-index: 1000;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-slider {\n  display: flex;\n  align-items: center;\n  height: 30px;\n  overflow: hidden;\n}\n\n.jp-EodagWidget-map {\n  height: 300px;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-field {\n  margin-top: 10px;\n  padding: 0 10px;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-field fieldset {\n  margin-top: 1.5em;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-input-name {\n  margin-top: 1em;\n  display: block;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-input-wrapper {\n  padding: 0px 8px;\n  border: 1px solid var(--jp-border-color0);\n  background: var(--jp-layout-color0);\n  height: 30px;\n  position: relative;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-input-wrapper:after {\n  content: ' ';\n  position: absolute;\n  right: 5px;\n  top: 5px;\n}\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-input-wrapper:focus-within {\n  border: 1px solid #2196f3;\n}\n.jp-EodagWidget .jp-EodagWidget-form .jp-EodagWidget-input {\n  background: transparent;\n  width: calc(100% - 18px);\n  float: left;\n  border: none;\n  outline: none;\n  font-size: var(--jp-ui-font-size1);\n  color: var(--jp-ui-font-color0);\n  line-height: var(--jp-private-commandpalette-search-height);\n}\n\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-additionnalParameters-fieldset\n  .section {\n  display: flex;\n}\n\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-additionnalParameters-fieldset\n  input {\n  margin: 0 0.1em;\n  line-height: var(--jp-private-commandpalette-search-height);\n  border: 1px solid var(--jp-border-color0);\n  background: var(--jp-layout-color0);\n  color: var(--jp-ui-font-color0);\n  width: 40%;\n}\n\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-additionnalParameters-fieldset\n  input:focus-within {\n  border: 1px solid #2196f3;\n}\n\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-additionnalParameters-fieldset\n  .jp-EodagWidget-additionnalParameters-addbutton {\n  cursor: pointer;\n  border-color: var(--jp-ui-font-color0);\n  margin: 0.5em 0;\n  height: 1.5rem;\n  border-radius: 5px;\n  background-color: var(--jp-layout-color0);\n  color: var(--jp-ui-font-color0);\n}\n\n.jp-EodagWidget\n  .jp-EodagWidget-form\n  .jp-EodagWidget-additionnalParameters-fieldset\n  .jp-EodagWidget-additionnalParameters-deletebutton {\n  cursor: pointer;\n  width: 16px;\n  height: 16px;\n  border-radius: 50%;\n  border-width: 0px;\n  color: #ffffff;\n  border-color: #124d77;\n  padding: 2px;\n  font-size: 12px;\n  line-height: 1;\n  text-align: center;\n  background-color: #216ba5;\n  margin-right: 0.1em;\n  position: relative;\n  top: 0.5rem;\n  margin: 0 0.1em;\n}\n\n.jp-EodagWidget-select__control {\n  background-color: var(--jp-layout-color0) !important;\n}\n\n.jp-EodagWidget-select__input,\n.jp-EodagWidget-select__control,\n.jp-EodagWidget-select__value-container,\n.jp-EodagWidget-select__indicatorindicators,\n.jp-EodagWidget-select__menu,\n.jp-EodagWidget-select__menu-list,\n.jp-EodagWidget-select__optiooption {\n  background-color: var(--jp-layout-color0);\n  font-size: var(--jp-ui-font-size1);\n  color: var(--jp-ui-font-color0);\n  line-height: var(--jp-private-commandpalette-search-height);\n}\n\n.jp-EodagWidget .jp-EodagWidget-form .react-datepicker-wrapper,\n.jp-EodagWidget .jp-EodagWidget-form .react-datepicker__input-container {\n  width: 100%;\n}\n.jp-EodagWidget input[type='range'] {\n  width: 100%;\n  -webkit-appearance: none;\n  outline: none;\n  background: var(--jp-layout-color0);\n}\n.jp-EodagWidget input[type='range']::-webkit-slider-runnable-track {\n  width: 100%;\n  height: 7px;\n  cursor: pointer;\n  background: var(--jp-layout-color0);\n  border-radius: 0px;\n  border: 1px solid var(--jp-border-color0);\n}\n.jp-EodagWidget input[type='range']::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  padding: 0;\n  height: 20px;\n  width: 20px;\n  border-radius: 50%;\n  background-color: var(--jp-brand-color1);\n  cursor: pointer;\n  outline: none;\n  color: var(--jp-brand-color1);\n  margin-top: -8px;\n}\n.jp-EodagWidget input[type='range']::-moz-range-track {\n  width: 100%;\n  height: 7px;\n  cursor: pointer;\n  background: var(--jp-layout-color0);\n  border-radius: 0px;\n  border: 1px solid var(--jp-border-color0);\n}\n.jp-EodagWidget input[type='range']::-moz-range-thumb {\n  appearance: none;\n  padding: 0;\n  height: 20px;\n  width: 20px;\n  border-radius: 50%;\n  background-color: var(--jp-brand-color1);\n  cursor: pointer;\n  outline: none;\n  color: var(--jp-brand-color1);\n  margin-top: -8px;\n}\n.jp-EodagWidget input[type='range']::-moz-range-progress {\n  height: 0;\n  background: transparent;\n}\n.jp-EodagWidget input[type='range']::-ms-track {\n  width: 100%;\n  height: 7px;\n  cursor: pointer;\n  background: var(--jp-layout-color0);\n  border-radius: 0px;\n  border: 1px solid var(--jp-border-color0);\n  color: transparent;\n}\n.jp-EodagWidget input[type='range']::-ms-thumb {\n  appearance: none;\n  padding: 0;\n  height: 20px;\n  width: 20px;\n  border-radius: 50%;\n  background-color: var(--jp-brand-color1);\n  cursor: pointer;\n  outline: none;\n  color: var(--jp-brand-color1);\n  margin-top: -8px;\n}\n.jp-EodagWidget input[type='range']::-ms-tooltip {\n  display: none;\n}\n.jp-EodagWidget input[type='range']::-ms-fill-lower {\n  background: transparent;\n}\n.jp-EodagWidget input[type='range']::-ms-fill-upper {\n  background: transparent;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-quicklook-wrapper {\n  display: flex;\n  justify-content: center;\n}\n.jp-EodagWidget-modal .jp-EodagWidget-small-quicklook {\n  max-height: 200px;\n  max-width: 200px;\n  cursor: zoom-in;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-modal-container {\n  display: flex;\n  height: calc(100vh - 48px);\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-product-wrapper {\n  display: flex;\n  flex-direction: column;\n  width: 50%;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-browse-wrapper {\n  height: calc(100% - 130px);\n}\n.jp-EodagWidget-modal .jp-EodagWidget-loading-wrapper {\n  margin-right: 10px;\n}\n.jp-EodagWidget-modal .jp-EodagWidget-browse-title {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  margin: 5px 0;\n  font-style: italic;\n  font-size: 0.9em;\n  height: 18px;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-desc-wrapper {\n  height: 100%;\n  width: 50%;\n  overflow: auto;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-right-buttons-wrapper {\n  display: flex;\n  justify-content: right;\n}\n\n.jp-EodagWidget-modal .jp-EodagWidget-title {\n  flex-grow: 1;\n}\n\n.jp-EodagWidget-appbar {\n  flex: 1 100%;\n  background-color: var(--jp-brand-color1);\n  padding: 12px 10px;\n  font-size: 20px;\n  color: white;\n}\n\n.jp-Eodag-tooltip {\n  max-width: 250px;\n  padding-right: 15px;\n  word-wrap: break-word;\n  z-index: 4;\n}\n\n#jp-left-stack {\n  z-index: 2;\n}\n.jp-EodagWidget::-webkit-scrollbar {\n  z-index: 0;\n}\n\n/* Design Table */\n\n.jp-EodagWidget-browse-wrapper .noClick {\n  cursor: initial;\n}\n.jp-EodagWidget-browse-wrapper .tableCell {\n  flex: 1;\n}\n.jp-EodagWidget-browse-wrapper .headerRow {\n  height: 40px;\n  border-bottom: 2px solid #2196f3;\n  color: #818181;\n}\n.jp-EodagWidget-browse-wrapper .tableRow {\n  cursor: pointer;\n  border-bottom: 1px solid rgba(180, 180, 180, 0.719);\n}\n.jp-EodagWidget-browse-wrapper .tableRow:hover {\n  background-color: rgba(180, 180, 180, 0.747);\n}\n.jp-EodagWidget-browse-wrapper .flexContainer {\n  text-align: center;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  justify-content: center;\n}\n.jp-EodagWidget-appbar button,\n.jp-EodagWidget-browse-wrapper button {\n  background: none;\n  border: none;\n  outline: none;\n  font-size: 18px;\n  cursor: pointer;\n}\n.jp-EodagWidget-appbar button {\n  color: white;\n}\n.jp-EodagWidget-apply {\n  float: right;\n  padding: 3px 6px;\n}\n.jp-EodagWidget-apply:hover {\n  background-color: rgba(255, 255, 255, 0.5);\n}\n.jp-EodagWidget-product h4 {\n  padding-left: 20px;\n}\n",""]);const a=o},2760:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(3645),o=n.n(r),a=n(1150),i=n(6388),l=n(7713),d=o()((function(e){return e[1]}));d.i(a.Z),d.i(i.Z),d.i(l.Z),d.push([e.id,"\n",""]);const s=d},6388:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3645),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".leaflet-container {\n  height: 100%;\n  width: 100%;\n  z-index: 0;\n}\n.leaflet-bar a.leaflet-disabled {\n  background-color: #e0e0e0 !important;\n}\n",""]);const a=o},7713:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3645),o=n.n(r)()((function(e){return e[1]}));o.push([e.id,".result-table {\n  width: 100%;\n  table-layout: fixed;\n  border-collapse: collapse;\n}\n.result-table tr {\n  border-bottom: 1px solid rgba(180, 180, 180, 0.719);\n}\n.result-table tr:hover {\n  background-color: rgba(180, 180, 180, 0.747);\n}\n.result-table td {\n  width: 50%;\n  padding: 18px 20px;\n  font-size: 15px;\n  border-bottom: 1px solid rgba(180, 180, 180, 0.719);\n}\n#endDate-error-text {\n  color: red;\n  margin-top: -3px;\n}\n",""]);const a=o}}]);