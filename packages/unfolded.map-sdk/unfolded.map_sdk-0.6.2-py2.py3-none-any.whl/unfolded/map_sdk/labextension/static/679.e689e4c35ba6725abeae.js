/*! For license information please see 679.e689e4c35ba6725abeae.js.LICENSE.txt */
(self.webpackChunk_unfolded_jupyter_map_sdk=self.webpackChunk_unfolded_jupyter_map_sdk||[]).push([[679],{679:(e,t,n)=>{"use strict";var i;n.r(t),n.d(t,{ActionType:()=>i,UnfoldedMap:()=>a,_addTileset:()=>v,addDataset:()=>A,addLayer:()=>S,createMap:()=>l,getLayerTimelineInfo:()=>g,getLayers:()=>E,getMapUrl:()=>s,getTimelineInfo:()=>f,refreshMapData:()=>L,removeDataset:()=>N,removeFilter:()=>R,removeLayer:()=>k,setFilter:()=>O,setLayerTimelineConfig:()=>M,setLayerVisibility:()=>p,setMapControlVisibility:()=>h,setTheme:()=>c,setTimelineAnimationSpeed:()=>I,setTimelineConfig:()=>y,setTimelineInterval:()=>_,setViewState:()=>d,toggleTimelineAnimation:()=>T,toggleTimelineVisibility:()=>m}),function(e){e.SET_VIEW_STATE="map-sdk-set-view-state",e.GET_LAYERS="map-sdk-get-layers",e.ADD_LAYER="map-sdk-add-layer",e.REMOVE_LAYER="map-sdk-remove-layer",e.SET_LAYER_VISIBILITY="map-sdk-set-layer-visibility",e.SET_THEME="map-sdk-set-theme",e.MAP_INITIALIZED="map-sdk-initialized",e.GET_TIMELINE_INFO="map-sdk-get-timeline-info",e.TOGGLE_TIMELINE_ANIMATION="map-sdk-toggle-timeline-animation",e.TOGGLE_TIMELINE_VISIBILITY="map-sdk-toggle-timeline-visibility",e.SET_TIMELINE_INTERVAL="map-sdk-set-timeline-interval",e.TIMELINE_INTERVAL_CHANGED="map-sdk-timeline-interval-changed",e.SET_TIMELINE_SPEED="map-sdk-set-timeline-speed",e.SET_TIMELINE_CONFIG="map-sdk-set-timeline-config",e.REFRESH_MAP_DATA="map-sdk-reload-map-data",e.GET_LAYER_TIMELINE_INFO="map-sdk-get-layer-timeline-info",e.LAYER_ANIMATION_TIME_CHANGED="map-sdk-layer-animation-time-changed",e.SET_LAYER_TIMELINE_CONFIG="map-sdk-set-layer-timeline-config",e.SET_MAP_CONTROL_VISIBILITY="map-sdk-set-map-control-visibility",e.ADD_TILESET_TO_MAP="map-sdk-add-tileset-top-map",e.ADD_DATASET_TO_MAP="map-sdk-add-dataset-to-map",e.REMOVE_DATASET_FROM_MAP="map-sdk-remove-dataset-from-map",e.SET_FILTER="map-sdk-set-filter",e.REMOVE_FILTER="map-sdk-remove-filter",e.FILTER_CHANGED="map-sdk-filter-changed",e.ON_HOVER="map-sdk-on-hover",e.ON_CLICK="map-sdk-on-click",e.ON_GEOMETRY_SELECTION="map-sdk-on-geometry-selection"}(i||(i={}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e){return"https://studio.unfolded.ai/public/"+e}var o=function(){function e(e,t){var n=this;this.mapEventHandlers={},this.iframe=e;var r=t.onLoad,s=t.onTimelineIntervalChange,o=t.onLayerTimelineTimeChange,a=t.onFilter,u=t.onHover,l=t.onClick,d=t.onGeometrySelection;this.mapEventHandlers={onLoad:r,onTimelineIntervalChange:s,onLayerTimelineTimeChange:o,onFilter:a,onHover:u,onClick:l,onGeometrySelection:d},window.addEventListener("message",(function(e){!function(e,t,n,r,s){var o=function(e){if("string"==typeof e.data){var t=function(e){try{return JSON.parse(e,(function(e,t){if(t&&"object"==typeof t&&t.hasOwnProperty("_type"))switch(t._type){case"bigint":return window.BigInt(t._value);default:return t}return t}))}catch(e){return null}}(e.data),n=t||{},i=n.type;if("unfolded-sdk-server"===n.source&&i)return t}}(e);if(o){var a=o.data,u=o.type;if(function(e,t,n){var r,s,o,a,u,l,d;switch(e){case i.MAP_INITIALIZED+"-response":null===(r=null==t?void 0:t.onLoad)||void 0===r||r.call(t);break;case i.TIMELINE_INTERVAL_CHANGED+"-response":null===(s=null==t?void 0:t.onTimelineIntervalChange)||void 0===s||s.call(t,n);break;case i.LAYER_ANIMATION_TIME_CHANGED+"-response":null===(o=null==t?void 0:t.onLayerTimelineTimeChange)||void 0===o||o.call(t,n);break;case i.FILTER_CHANGED+"-response":null===(a=null==t?void 0:t.onFilter)||void 0===a||a.call(t,n);break;case i.ON_HOVER+"-response":null===(u=null==t?void 0:t.onHover)||void 0===u||u.call(t,n);break;case i.ON_CLICK+"-response":null===(l=null==t?void 0:t.onClick)||void 0===l||l.call(t,n);break;case i.ON_GEOMETRY_SELECTION+"-response":null===(d=null==t?void 0:t.onGeometrySelection)||void 0===d||d.call(t,n)}}(u,s,a),t&&n&&r)switch(u){case t+"-response":n(a);break;case t+"-error":r(new Error(null==a?void 0:a.message))}}}(e,n.type,n.resolve,n.reject,n.mapEventHandlers)}))}return e.prototype.sendMessage=function(e,t){var n=this,i=this.iframe;return new Promise((function(r,s){var o=function(e){var t=new Set;try{return JSON.stringify(e,(function(e,n){if("bigint"==typeof n)return{_type:"bigint",_value:n.toString()};if("object"==typeof n&&null!==n){if(t.has(n))try{return JSON.parse(JSON.stringify(n))}catch(e){return}t.add(n)}return n}))}catch(e){return null}}({type:e,source:"unfolded-sdk-client",data:t});o&&i&&i.contentWindow&&(i.contentWindow.postMessage(o,"*"),n.type=e,n.resolve=r,n.reject=s)}))},e.prototype.setMapEventHandlers=function(e){this.mapEventHandlers=e?r(r({},this.mapEventHandlers),e):{}},e}(),a=function(){function e(e){this.iframe=document.createElement("iframe"),this._transport=new o(this.iframe,e),function(e,t){var n=t||{},i=n.id,r=void 0===i?"unfolded_iframe":i,o=n.appendToElement,a=n.appendToDocument,l=void 0===a||a,d=n.appendToId,E=void 0===d?null:d,p=n.embed,c=void 0!==p&&p,f=n.width,T=void 0===f?"100%":f,m=n.height,_=void 0===m?"100%":m,I=t.mapUUID?s(t.mapUUID):t.mapUrl;I||(I="https://studio.unfolded.ai/incognito"),c&&(I+="/embed"),e.setAttribute("src",I),e.setAttribute("id",r),e.setAttribute("width",""+T),e.setAttribute("height",""+_),e.style.width=u(T),e.style.height=u(_);var y=function(e,t,n){if(e||t){var i=e||(t?document.getElementById(t):null);if(i instanceof HTMLElement)return i}else if(n)return document.body}(o,E,l);if(y)!function(e,t,n){var i=e.querySelector&&e.querySelector("iframe#"+t);i?i.replaceWith(n):e.appendChild(n)}(y,r,e);else if(l)throw new Error("Target container element not found")}(this.iframe,e)}return e.prototype.sendMessage=function(e,t){return this._transport.sendMessage(e,t)},e.prototype.setMapEventHandlers=function(e){this._transport.setMapEventHandlers(e)},e.prototype.setViewState=function(e){return this.sendMessage(i.SET_VIEW_STATE,{viewState:e})},e.prototype.getLayers=function(){return this.sendMessage(i.GET_LAYERS,{})},e.prototype.setLayerVisibility=function(e,t){return this.sendMessage(i.SET_LAYER_VISIBILITY,{layerId:e,isVisible:t})},e.prototype.setTheme=function(e){return this.sendMessage(i.SET_THEME,{theme:e})},e.prototype.getTimelineInfo=function(e){return this.sendMessage(i.GET_TIMELINE_INFO,{idx:e})},e.prototype.setTimelineConfig=function(e){return this.sendMessage(i.SET_TIMELINE_CONFIG,{config:e})},e.prototype.refreshMapData=function(){return this.sendMessage(i.REFRESH_MAP_DATA,{})},e.prototype.getLayerTimelineInfo=function(){return this.sendMessage(i.GET_LAYER_TIMELINE_INFO,{})},e.prototype.setLayerTimelineConfig=function(e){return this.sendMessage(i.SET_LAYER_TIMELINE_CONFIG,{config:e})},e.prototype.setMapControlVisibility=function(e){return this.sendMessage(i.SET_MAP_CONTROL_VISIBILITY,{config:e})},e.prototype._addTileset=function(e){return this.sendMessage(i.ADD_TILESET_TO_MAP,{tileset:e})},e.prototype.addDataset=function(e,t){return void 0===t&&(t=!0),this.sendMessage(i.ADD_DATASET_TO_MAP,{dataset:"string"==typeof e?{uuid:e}:e,autoCreateLayers:t}).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeDataset=function(e){return this.sendMessage(i.REMOVE_DATASET_FROM_MAP,{uuid:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.addLayer=function(e){return this.sendMessage(i.ADD_LAYER,{layer:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeLayer=function(e){return this.sendMessage(i.REMOVE_LAYER,{id:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.setFilter=function(e){return this.sendMessage(i.SET_FILTER,{info:e}).then((function(e){return e&&"ok"===e.status}))},e.prototype.removeFilter=function(e){return this.sendMessage(i.REMOVE_FILTER,{id:e}).then((function(e){return e&&"ok"===e.status}))},e}();function u(e){return"number"==typeof e?e+"px":e}function l(e){return new a(e)}function d(e,t){return e.setViewState(t)}function E(e){return e.getLayers()}function p(e,t,n){return e.setLayerVisibility(t,n)}function c(e,t){return e.setTheme(t)}function f(e,t){return e.getTimelineInfo(t)}function T(e,t){return e.sendMessage(i.TOGGLE_TIMELINE_ANIMATION,{idx:t})}function m(e,t){return e.sendMessage(i.TOGGLE_TIMELINE_VISIBILITY,{idx:t})}function _(e,t,n,r){return e.sendMessage(i.SET_TIMELINE_INTERVAL,{idx:t,startTime:n,endTime:r})}function I(e,t,n){return e.sendMessage(i.SET_TIMELINE_SPEED,{idx:t,speed:n})}function y(e,t){return e.setTimelineConfig(t)}function L(e){return e.refreshMapData()}function g(e){return e.getLayerTimelineInfo()}function M(e,t){return e.setLayerTimelineConfig(t)}function h(e,t){return e.setMapControlVisibility(t)}function v(e,t){return e._addTileset(t)}function A(e,t){return e.addDataset(t)}function N(e,t){return e.removeDataset(t)}function S(e,t){return e.addLayer(t)}function k(e,t){return e.removeLayer(t)}function O(e,t){return e.setFilter(t)}function R(e,t){return e.removeFilter(t)}}}]);